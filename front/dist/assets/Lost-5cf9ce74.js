import{c as D,r as k}from"./request-6080a32f.js";import{u as he}from"./index-30a7062a.js";import{T as be,E as we}from"./index.esm-2d42c9cb.js";import{bc as v}from"./index-756fa734.js";import{r as f,V as H,v as Ce,j as ke,a7 as s,y as m,z as L,A as r,P as e,I as t,M as d,u,H as b,L as y,O as Y,F as Ve,a0 as xe,S as q}from"./runtime-core.esm-bundler-94adbe8c.js";import"./runtime-dom.esm-bundler-ffed9dc3.js";const Ue=r("span",{style:{"vertical-align":"middle"}}," Query ",-1),Se=r("span",{style:{"vertical-align":"middle"}}," Clear ",-1),Ie={style:{margin:"10px 0"}},Oe=r("span",{style:{"vertical-align":"middle"}}," Add to ",-1),De=r("span",{style:{"vertical-align":"middle"}}," Import ",-1),Le=r("span",{style:{"vertical-align":"middle"}}," Export ",-1),Ne=r("span",{style:{"vertical-align":"middle"}}," Batch Deletion ",-1),ze={style:{margin:"10px 0"}},Be={key:0},Pe={key:0},Ee={class:"page"},Re={style:{border:"1px solid #ccc"}},Te={class:"dialog-footer"},$e=["innerHTML"],Ae={class:"dialog-footer"},Qe={__name:"Lost",setup(Fe){const x=f(""),N=f(1),z=f(5),R=f(0),B=he(),P=B.getBearerToken,w=B.getAuths;B.getUser;const a=H({tableData:[],form:{}}),V=f(""),E=Ce(),J={placeholder:"Please enter content...",MENU_CONF:{uploadImage:{fieldName:"file",server:`http://${D.serverUrl}/file/uploadImg`,headers:{Authorization:P}}}},T=f(""),U=f(!1),j=n=>{U.value=!0,T.value=n},Q=n=>{E.value=n};ke(()=>{const n=E.value;n!=null&&n.destroy()}),a.categoryOptions=[],k.get("/category").then(n=>a.categoryOptions=n.data),a.userOptions=[],k.get("/user").then(n=>a.userOptions=n.data);const S=f([]),G=n=>{S.value=n},K=()=>{if(!S.value||!S.value.length){v.warning("Please select data");return}const n=S.value.map(o=>o.id);k.post("/lost/del/batch",n).then(o=>{o.code==="200"?(v.success("Operation successful"),_()):v.error(o.msg)})},_=()=>{k.get("/lost/page",{params:{name:x.value,pageNum:N.value,pageSize:z.value}}).then(n=>{a.tableData=n.data.records,R.value=n.data.total})};_();const W=()=>{x.value="",_()},C=f(!1),X=H({name:[{required:!0,message:"Please enter a name",trigger:"blur"}]}),I=f(),Z=()=>{C.value=!0,q(()=>{I.value.resetFields(),a.form={},V.value=""})},ee=()=>{I.value.validate(n=>{n&&(a.form.content=V.value,k.request({url:"/lost",method:a.form.id?"put":"post",data:a.form}).then(o=>{o.code==="200"?(v.success("save successfully"),C.value=!1,_()):v.error(o.msg)}))})},te=n=>{C.value=!0,q(()=>{I.value.resetFields(),a.form=JSON.parse(JSON.stringify(n)),V.value=n.content})},le=n=>{k.delete("/lost/"+n).then(o=>{o.code==="200"?(v.success("Operation successful"),_()):v.error(o.msg)})},oe=()=>{window.open(`http://${D.serverUrl}/lost/export`)},ae=()=>{_(),v.success("Import Success")},ne=n=>{a.form.img=n.data,v.success("Upload Successfully")};return(n,o)=>{const O=s("el-input"),se=s("Search"),g=s("el-icon"),i=s("el-button"),re=s("RefreshLeft"),ie=s("Plus"),de=s("Bottom"),$=s("el-upload"),ue=s("Top"),A=s("Remove"),F=s("el-popconfirm"),c=s("el-table-column"),ce=s("el-image"),me=s("Edit"),pe=s("el-table"),fe=s("el-pagination"),_e=s("el-option"),ve=s("el-select"),h=s("el-form-item"),ge=s("el-date-picker"),ye=s("el-form"),M=s("el-dialog");return m(),L("div",null,[r("div",null,[e(O,{modelValue:x.value,"onUpdate:modelValue":o[0]||(o[0]=l=>x.value=l),placeholder:"Please enter a name",class:"w300"},null,8,["modelValue"]),e(i,{type:"primary",class:"ml5",onClick:_},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(se)]),_:1}),d(),Ue]),_:1}),e(i,{type:"warning",class:"ml5",onClick:W},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(re)]),_:1}),d(),Se]),_:1})]),r("div",Ie,[u(w).includes("lost.add")?(m(),b(i,{key:0,type:"success",onClick:Z},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(ie)]),_:1}),d(),Oe]),_:1})):y("",!0),u(w).includes("lost.import")?(m(),b($,{key:1,class:"ml5","show-file-list":!1,style:{display:"inline-block",position:"relative",top:"3px"},action:`http://${u(D).serverUrl}/lost/import`,"on-success":ae,headers:{Authorization:u(P)}},{default:t(()=>[e(i,{type:"primary"},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(de)]),_:1}),d(),De]),_:1})]),_:1},8,["action","headers"])):y("",!0),u(w).includes("lost.export")?(m(),b(i,{key:2,type:"primary",onClick:oe,class:"ml5"},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(ue)]),_:1}),d(),Le]),_:1})):y("",!0),u(w).includes("lost.deleteBatch")?(m(),b(F,{key:3,title:"are you sure you want to delete?",onConfirm:K},{reference:t(()=>[e(i,{type:"danger",style:{"margin-left":"5px"}},{default:t(()=>[e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(A)]),_:1}),d(),Ne]),_:1})]),_:1})):y("",!0)]),r("div",ze,[e(pe,{data:a.tableData,stripe:"",border:"",onSelectionChange:G,"header-cell-class-name":"headerBg"},{default:t(()=>[e(c,{type:"selection",width:"55"}),e(c,{prop:"id",label:"number"}),e(c,{label:"Item Classification"},{default:t(l=>[l.row.category_id?(m(),L("span",Be,Y(a.categoryOptions.find(p=>p.id===l.row.category_id)?a.categoryOptions.find(p=>p.id===l.row.category_id).name:""),1)):y("",!0)]),_:1}),e(c,{prop:"name",label:"Item Name"}),e(c,{label:"Item Image"},{default:t(l=>[e(ce,{"preview-teleported":"",style:{width:"80px",height:"80px"},src:l.row.img,"preview-src-list":[l.row.img]},null,8,["src","preview-src-list"])]),_:1}),e(c,{label:"Item Description"},{default:t(l=>[e(i,{onClick:p=>j(l.row.content)},{default:t(()=>[d("Check")]),_:2},1032,["onClick"])]),_:1}),e(c,{prop:"address",label:"Lost location"}),e(c,{prop:"time",label:"Lost time"}),e(c,{prop:"phone",label:"Contact Details"}),e(c,{label:"Publisher"},{default:t(l=>[l.row.user_id?(m(),L("span",Pe,Y(a.userOptions.find(p=>p.id===l.row.user_id)?a.userOptions.find(p=>p.id===l.row.user_id).name:""),1)):y("",!0)]),_:1}),e(c,{label:"operate",width:"220"},{default:t(l=>[u(w).includes("lost.edit")?(m(),b(i,{key:0,type:"primary",onClick:p=>te(l.row)},{default:t(()=>[d("Revise"),e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(me)]),_:1})]),_:2},1032,["onClick"])):y("",!0),u(w).includes("lost.delete")?(m(),b(F,{key:1,title:"are you sure you want to delete?",onConfirm:p=>le(l.row.id)},{reference:t(()=>[e(i,{type:"danger"},{default:t(()=>[d("delete"),e(g,{style:{"vertical-align":"middle"}},{default:t(()=>[e(A)]),_:1})]),_:1})]),_:2},1032,["onConfirm"])):y("",!0)]),_:1})]),_:1},8,["data"])]),r("div",Ee,[e(fe,{"prev-text":"previous","next-text":"next",onCurrentChange:_,onSizeChange:_,"current-page":N.value,"onUpdate:current-page":o[1]||(o[1]=l=>N.value=l),"page-size":z.value,"onUpdate:page-size":o[2]||(o[2]=l=>z.value=l),background:"","page-sizes":[4,8,12,16],layout:"prev, pager, next, total",total:R.value},null,8,["current-page","page-size","total"])]),e(M,{modelValue:C.value,"onUpdate:modelValue":o[10]||(o[10]=l=>C.value=l),title:"Lost property information",width:"40%"},{footer:t(()=>[r("span",Te,[e(i,{onClick:o[9]||(o[9]=l=>C.value=!1)},{default:t(()=>[d("Cancel")]),_:1}),e(i,{type:"primary",onClick:ee},{default:t(()=>[d(" save ")]),_:1})])]),default:t(()=>[e(ye,{ref_key:"ruleFormRef",ref:I,rules:X,model:a.form,"label-width":"125px",style:{padding:"0 20px"},"status-icon":""},{default:t(()=>[e(h,{prop:"categoryId",label:"Item Classification"},{default:t(()=>[e(ve,{clearable:"",modelValue:a.form.category_id,"onUpdate:modelValue":o[3]||(o[3]=l=>a.form.category_id=l),placeholder:"Please select",style:{width:"100%"}},{default:t(()=>[(m(!0),L(Ve,null,xe(a.categoryOptions,l=>(m(),b(_e,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(h,{prop:"name",label:"Item Name"},{default:t(()=>[e(O,{modelValue:a.form.name,"onUpdate:modelValue":o[4]||(o[4]=l=>a.form.name=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(h,{prop:"img",label:"Item Image"},{default:t(()=>[e($,{"show-file-list":!1,action:`http://${u(D).serverUrl}/file/upload`,ref:"file",headers:{Authorization:u(P)},"on-success":ne},{default:t(()=>[e(i,{size:"small",type:"primary"},{default:t(()=>[d("Click Upload")]),_:1})]),_:1},8,["action","headers"])]),_:1}),e(h,{prop:"content",label:"Item Description"},{default:t(()=>[r("div",Re,[e(u(be),{style:{"border-bottom":"1px solid #ccc"},editor:u(E),mode:"simple"},null,8,["editor"]),e(u(we),{style:{height:"300px","overflow-y":"hidden"},modelValue:V.value,"onUpdate:modelValue":o[5]||(o[5]=l=>V.value=l),defaultConfig:J,mode:"simple",onOnCreated:Q},null,8,["modelValue"])])]),_:1}),e(h,{prop:"address",label:"Lost location"},{default:t(()=>[e(O,{modelValue:a.form.address,"onUpdate:modelValue":o[6]||(o[6]=l=>a.form.address=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(h,{prop:"time",label:"Lost time"},{default:t(()=>[e(ge,{style:{width:"100%"},modelValue:a.form.time,"onUpdate:modelValue":o[7]||(o[7]=l=>a.form.time=l),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"Select date and time"},null,8,["modelValue"])]),_:1}),e(h,{prop:"phone",label:"Contact Details"},{default:t(()=>[e(O,{modelValue:a.form.phone,"onUpdate:modelValue":o[8]||(o[8]=l=>a.form.phone=l),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),e(M,{modelValue:U.value,"onUpdate:modelValue":o[12]||(o[12]=l=>U.value=l),title:"Preview",width:"40%"},{footer:t(()=>[r("span",Ae,[e(i,{onClick:o[11]||(o[11]=l=>U.value=!1)},{default:t(()=>[d("closure")]),_:1})])]),default:t(()=>[r("div",{id:"editor-content-view",class:"editor-content-view",innerHTML:T.value,style:{padding:"0 20px"}},null,8,$e)]),_:1},8,["modelValue"])])}}};export{Qe as default};
